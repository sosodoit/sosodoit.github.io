---
layout: page
title: "[ISLR] 데이터마이닝 솔루션 (3)"
description: 
headline:
categories: data-science
tags: [data-science]
comments: true
published: true
---

지도학습 중 분류 문제에 사용하는 알고리즘

k-NN 알고리즘

새로운 데이터(x)가 ‘어떤그룹’의 데이터와 ’가장’ 가까우니 x는 ’어떤그룹’이다. 라고 분류하는 알고리즘!

k의 역할은 몇 번째로 가까운 데이터까지 살펴볼 것인가를 정한 숫자!

k-NN에서 가깝다는 개념은 유클리드 거리로 정의!

## (a) 각 관측치와 test point 사이의 유클리드 거리를 계산
<img src="/images/2020-09/7a.png"  width="700" height="370">

```r
eg7 <- data.frame(X1 = c(0, 2, 0, 0, -1, 1), X2 = c(3, 0, 1, 1, 0, 1), 
                  X3 = c(0, 0, 3, 2, 1, 1), Y = c('Red', 'Red', 'Red', 'Green', 'Green', 'Red'))
Q <- c(0, 0, 0)
eg7$d <- sqrt((eg7$X1 - Q[1])^2 + (eg7$X2 - Q[2])^2 + (eg7$X3 - Q[3])^2)
eg7
##   X1 X2 X3     Y        d
## 1  0  3  0   Red 3.000000
## 2  2  0  0   Red 2.000000
## 3  0  1  3   Red 3.162278
## 4  0  1  2 Green 2.236068
## 5 -1  0  1 Green 1.414214
## 6  1  1  1   Red 1.732051
```

## (b) k=1일때 예측과 이유
<img src="/images/2020-09/7b.jpeg"  width="700" height="370">
k=1 이라면, 유클리드 거리가 (1번째로 가까운) d=1.414214로 test point와 가장 가까운 5번 관측치가 Green그룹이므로 우리의 예측은 Green이다.

```r
min(eg7$d)
## [1] 1.414214
eg7$Y[eg7$d==min(eg7$d)]
## [1] "Green"
```

## (c) k=3일때 예측과 이유
<img src="/images/2020-09/7c.jpeg"  width="700" height="370">
k=3 이라면, 유클리드 거리가 (3번째로 가까운) d=1.41, d=1.71, d=2.00까지 보고 신규 데이터를 분류한다. 이때 각 관측치가 속해있는 그룹이 다르면 다수결의 원칙에 따른다. 여기서는 test point와 가장 가까운 거리에 있는 3개 중 하나가 Green그룹이고 두개가 Red그룹이므로 우리의 예측은 Red이다.

```r
sort(eg7$d)[1:3]
## [1] 1.414214 1.732051 2.000000
```

## (d) 베이즈결정경계가 매우 비선형적이라면 k에 대한 값이 어떤지 예상 가능? why?
베이즈 결정 경계가 매우 비선형적이라면 k값은 작을 것으로 예상된다. 왜냐하면 베이즈 결정 경계가 highly non-linear라는 것은 flexible할 것이고 즉, 평활도(smoothness)가 낮다는 의미이다.  

예를 들어, 아래 그림처럼, 극단적으로 k의 값이 1일 때와 100일 때를 비교해보자. k = 1일 때, 그 점의 가장 가까운 한 개의 점만을 참조하므로 조금 움직일 때마다 참조하는 점이 바뀌게 된다. 즉 평활도가 낮아진다. 따라서 비선형적인 경계를 설명할 때 좋다. 반대로 k = 100일 때, 참조하는 점은 주변의 100개의 점으로, 움직여도 100개의 점이 그렇게 많이 변화하지 않아 평활도가 매우 높다. 따라서 k가 크면 결정 경계가 선형적인 모습을 보이고, k가 작으면 결정 경계가 유연한 비선형적인 모습을 보인다. 

따라서 베이즈 결정 경계가 매우 비선형적이라면 k값이 작은 것이 유용하다!
<img src="/images/2020-09/7d.jpeg"  width="700" height="370">